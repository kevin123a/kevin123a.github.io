<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>VVIP Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
  <style>
    :root{
      --bg:#f7f7f9; --sidebar:#420D09; --accent:#FDC12A; --text:#222;
    }
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh;}
    .sidebar{width:260px;background:var(--sidebar);color:var(--accent);display:flex;flex-direction:column;padding:18px 0;gap:6px;box-shadow:2px 0 8px rgba(0,0,0,0.08);position:relative}
    .sidebar h2{margin:0;color:var(--accent);font-size:20px}
    .sidebar a{display:flex;align-items:center;padding:10px 18px;gap:10px;color:var(--accent);text-decoration:none;cursor:pointer;font-weight:600}
    .sidebar a:hover{background:rgba(253,193,42,0.12)}
    .submenu{display:none;flex-direction:column;padding-left:34px;background:rgba(253,193,42,0.03)}
    .submenu a{font-weight:500;padding:8px 18px;font-size:14px}
    .content{flex:1;padding:22px;overflow:auto}
    header.small{margin-bottom:18px}
    header.small h1{margin:0;color:var(--sidebar)}
    .muted{color:#666;font-size:14px}
    .btn{background:var(--accent);color:var(--sidebar);padding:6px 12px;border-radius:6px;border:none;cursor:pointer;font-weight:600}
    .dark{--bg:#111;--sidebar:#111;--accent:#FFD559;--text:#eee}
    .sidebar-footer{margin-top:auto;padding:12px;text-align:center}
    .sidebar-footer img{width:20px;height:20px;vertical-align:middle;margin-right:6px}
  </style>
</head>
<body>
  <button class="toggle-mobile" onclick="document.getElementById('sidebar').classList.toggle('active')"><i class="fa fa-bars"></i></button>

  <!-- SIDEBAR -->
  <div class="sidebar" id="sidebar">
    <div style="text-align:center;margin-bottom:14px">
      <h2>VVIP Dashboard</h2>
    </div>

    <a onclick="showContent('overview')"><i class="fa-solid fa-gauge-high"></i> Overview</a>
    <a onclick="showContent('projects')"><i class="fa-solid fa-briefcase"></i> Projects</a>
    <a onclick="showContent('clients')"><i class="fa-solid fa-users"></i> Clients</a>

    <a onclick="toggleMenu('financeSub')"><i class="fa-solid fa-sack-dollar"></i> Finance <i class="fa fa-caret-down" style="margin-left:auto"></i></a>
    <div class="submenu" id="financeSub">
      <a onclick="showContent('cashflow')">üí∞ Cashflow</a>
      <a onclick="showContent('tax')">üìä Tax</a>
      <a onclick="showContent('payroll')">üë• Payroll</a>
    </div>

    <a onclick="toggleMenu('contractsSub')"><i class="fa-solid fa-file-contract"></i> Contracts <i class="fa fa-caret-down" style="margin-left:auto"></i></a>
    <div class="submenu" id="contractsSub">
      <a onclick="showContent('drafts')">‚úèÔ∏è Drafts</a>
      <a onclick="showContent('signed')">‚úÖ Signed</a>
      <a onclick="showContent('archives')">üì¶ Archives</a>
    </div>

    <a onclick="showContent('compliance')"><i class="fa-solid fa-scale-balanced"></i> Compliance</a>

    <a onclick="toggleMenu('investmentSub')"><i class="fa-solid fa-lightbulb"></i> Investment <i class="fa fa-caret-down" style="margin-left:auto"></i></a>
    <div class="submenu" id="investmentSub">
      <a onclick="showContent('portfolio')">üìã Portfolio</a>
      <a onclick="showContent('IHSG')">üìà IHSG & Markets</a>
    </div>

    <a onclick="showContent('reports')"><i class="fa-solid fa-chart-pie"></i> Reports</a>
    <a onclick="showContent('settings')"><i class="fa-solid fa-gears"></i> Settings</a>

    <hr style="margin:10px 0;border:0;border-top:1px solid rgba(255,255,255,0.2)">
    <a href="vvip-pro.html"><i class="fa-solid fa-crown"></i> VVIP Pro</a>
    <a href="vvip-plus.html"><i class="fa-solid fa-gem"></i> VVIP Plus</a>

    <div class="sidebar-footer muted">
      <div style="font-weight:700"><img src="logo.png" alt="Logo"> PT Sinar Langit Hanoi</div>
      <div style="font-size:12px">Jl. Nakula, Tanjunganom, Nganjuk</div>
      <div style="margin-top:8px"><button class="btn" onclick="logout()">Logout</button></div>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <div class="content" id="mainContent">
    <header class="small">
      <h1>Welcome, PT Sinar Langit Hanoi</h1>
    </header>
    <div id="viewArea"></div>
  </div>

  <script>
    function toggleMenu(id){
      document.getElementById(id).style.display =
        document.getElementById(id).style.display === "flex" ? "none" : "flex";
    }
    function logout(){ alert("Logout berhasil!"); }

    function showContent(page){
      const area = document.getElementById("viewArea");
      area.innerHTML = "";
      if(page==="IHSG"){ renderIHSG(area); }
      else{ area.innerHTML="<h2>"+page+"</h2><p class='muted'>Konten "+page+" masih kosong.</p>"; }
    }

    // === IHSG CANDLESTICK REAL ===
    let ihsgChart;
    async function fetchIHSGData(){
      try{
        const url="https://query1.finance.yahoo.com/v8/finance/chart/^JKSE?range=5d&interval=1d";
        const res=await fetch(url);
        const data=await res.json();
        const result=data.chart.result[0];
        const quotes=result.indicators.quote[0];
        const timestamps=result.timestamp;
        return timestamps.map((t,i)=>({
          x:new Date(t*1000),
          o:quotes.open[i],
          h:quotes.high[i],
          l:quotes.low[i],
          c:quotes.close[i]
        }));
      }catch(e){
        console.error("IHSG fetch error",e);
        return [];
      }
    }

    async function renderIHSG(target){
      target.innerHTML=`
        <h2>IHSG (Real dari Yahoo Finance)</h2>
        <p class="muted">Candlestick ¬∑ Auto refresh tiap 60 detik</p>
        <div style="max-width:900px"><canvas id="chartIHSG"></canvas></div>
      `;
      const data=await fetchIHSGData();
      const ctx=document.getElementById("chartIHSG").getContext("2d");
      if(ihsgChart) ihsgChart.destroy();
      ihsgChart=new Chart(ctx,{
        type:"candlestick",
        data:{datasets:[{label:"IHSG",data:data,borderColor:"#420D09"}]},
        options:{responsive:true}
      });
    }

    // auto refresh IHSG tiap 60 detik
    setInterval(()=>{
      if(document.getElementById("chartIHSG")){
        renderIHSG(document.getElementById("viewArea"));
      }
    },60000);
  </script>
</body>
</html>
