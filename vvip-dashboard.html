<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>VVIP Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Font Awesome & Chart.js -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Chart.js financial plugin (untuk candlestick) -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>

  <style>
    :root{--bg:#f7f7f9;--sidebar:#420D09;--accent:#FDC12A;--text:#222;}
    body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh;}
    .sidebar{width:260px;background:var(--sidebar);color:var(--accent);display:flex;flex-direction:column;padding:18px 0;gap:6px}
    .sidebar .logo{display:flex;flex-direction:column;align-items:center;margin-bottom:10px}
    .sidebar .logo img{width:44px;height:44px;border-radius:6px;margin-bottom:6px}
    .sidebar h2{margin:0;color:var(--accent);font-size:18px}
    .sidebar a{display:flex;align-items:center;padding:10px 18px;gap:10px;color:var(--accent);text-decoration:none;font-weight:600}
    .sidebar a:hover{background:rgba(253,193,42,0.12)}
    .submenu{display:none;flex-direction:column;padding-left:34px;background:rgba(253,193,42,0.03)}
    .submenu a{font-weight:500;padding:8px 18px;font-size:14px}
    .content{flex:1;padding:22px;overflow:auto}
    header.small{margin-bottom:18px;display:flex;justify-content:space-between;align-items:center}
    header.small h1{margin:0;color:var(--sidebar);font-size:20px}
    .btn{background:var(--accent);color:var(--sidebar);padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
    .muted{color:#666;font-size:14px}
    .dark{--bg:#111;--sidebar:#111;--accent:#FFD559;--text:#eee}
  </style>
</head>
<body>
  <!-- SIDEBAR -->
  <div class="sidebar" id="sidebar">
    <div class="logo">
      <img src="logo.png" alt="logo">
      <h2>VVIP Dashboard</h2>
    </div>

    <a onclick="showContent('overview')"><i class="fa-solid fa-gauge-high"></i> Overview</a>
    <a onclick="toggleMenu('investmentSub')"><i class="fa-solid fa-lightbulb"></i> Investment <i class="fa fa-caret-down" style="margin-left:auto"></i></a>
    <div class="submenu" id="investmentSub">
      <a onclick="showContent('IHSG')">üìà IHSG</a>
      <a onclick="showContent('markets')">üåç Markets (Regional)</a>
    </div>

    <div style="margin-top:auto;padding:12px;text-align:center" class="muted">
      <div style="font-weight:700"><img src="logo.png" style="width:16px;height:16px;margin-right:6px;vertical-align:middle"> PT Sinar Langit Hanoi</div>
      <div style="font-size:12px">Jl. Nakula, Tanjunganom, Nganjuk</div>
      <div style="margin-top:8px"><button class="btn" onclick="logout()"><img src="logo.png" style="width:16px;height:16px;margin-right:8px;vertical-align:middle"> Logout</button></div>
    </div>
  </div>

  <!-- MAIN -->
  <div class="content" id="mainContent">
    <header class="small">
      <h1>VVIP Dashboard</h1>
      <button class="btn" onclick="toggleDark()">üåô</button>
    </header>
    <div id="viewArea"></div>
  </div>

  <script>
  function toggleMenu(id){ 
    const el=document.getElementById(id); 
    el.style.display=(el.style.display==='flex')?'none':'flex'; 
  }
  function toggleDark(){ document.documentElement.classList.toggle('dark'); }
  function logout(){ window.location.href='vvip.html'; }
  function showContent(menu){
    const view=document.getElementById('viewArea'); 
    view.innerHTML='';
    if(menu==='overview'){ view.innerHTML='<h2>Overview</h2><p class="muted">Konten overview aman (tidak diubah).</p>'; }
    if(menu==='IHSG'){ renderIHSG(view); }
    if(menu==='markets'){ renderMarkets(view); }
  }

  /* ========== IHSG dengan Candlestick & Data Publik (gratis) ========== */
  let ihsgChart;
  async function fetchIHSG(){
    try{
      // sumber publik dummy OHLC dari GitHub (update berkala, gratis)
      const res=await fetch("https://raw.githubusercontent.com/plotly/datasets/master/finance-charts-apple.json");
      const data=await res.json();
      // mapping ke IHSG simulasi
      return data.slice(0,30).map(d=>({
        x:new Date(d.Date),
        o:d.AAPL.Open,
        h:d.AAPL.High,
        l:d.AAPL.Low,
        c:d.AAPL.Close
      }));
    }catch(e){
      console.error("fetch IHSG error",e);
      return [];
    }
  }
  async function renderIHSG(target){
    target.innerHTML='<h2>IHSG (Candlestick)</h2><canvas id="ihsgChart" height="300"></canvas><div class="muted">Data gratis publik (simulasi Apple ‚Üí IHSG). Auto refresh tiap ¬±60 detik.</div>';
    const ctx=document.getElementById('ihsgChart').getContext('2d');
    const ohlc=await fetchIHSG();
    if(ihsgChart) ihsgChart.destroy();
    ihsgChart=new Chart(ctx,{
      type:'candlestick',
      data:{datasets:[{label:'IHSG',data:ohlc,borderColor:'#420D09'}]},
      options:{responsive:true}
    });
    if(window._ihsgInterval) clearInterval(window._ihsgInterval);
    window._ihsgInterval=setInterval(()=>renderIHSG(document.getElementById('viewArea')),60000);
  }

  /* ========== Markets (dummy line chart) ========== */
  let mCharts={};
  function renderMarkets(target){
    target.innerHTML='<h2>Markets Regional</h2><canvas id="mChart"></canvas><div class="muted">Data simulasi. (Belum real-time)</div>';
    const ctx=document.getElementById('mChart').getContext('2d');
    if(mCharts.m) mCharts.m.destroy();
    mCharts.m=new Chart(ctx,{type:'line',data:{labels:[1,2,3,4,5],datasets:[{label:"VN-Index",data:[1200,1210,1220,1215,1230],borderColor:"#2196F3"}]}});
  }

  // default
  showContent('overview');
  </script>
</body>
</html>
